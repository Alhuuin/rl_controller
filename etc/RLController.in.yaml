---
# If true, the FSM transitions are managed by an external tool
Managed: false
# If true and the FSM is self-managed, transitions should be triggered
StepByStep: true
# Change idle behaviour, if true the state is kept until transition,
# otherwise the FSM holds the last state until transition
IdleKeepState: false
# Where to look for state libraries
StatesLibraries:
- "@MC_STATES_DEFAULT_RUNTIME_INSTALL_PREFIX@"
- "@MC_STATES_RUNTIME_INSTALL_PREFIX@"
# Where to look for state files
StatesFiles:
- "@MC_STATES_DEFAULT_RUNTIME_INSTALL_PREFIX@/data"
- "@MC_STATES_RUNTIME_INSTALL_PREFIX@/data"
# If true, state factory will be more verbose
VerboseStateFactory: false

# Robot and environment setup
robots:
  ground:
    module: "env/ground"

# Collision constraint
collisions:
- type: collision
  useMinimal: true

ObserverPipelines:
  name: MainPipeline
  gui: true
  log: true

  observers:
    - type: Encoder
      config:
          velocity: encoderVelocities

    - type: Tilt
      required: true
      update: true
      config:
        anchorFrameFunction: anchorFrameFunction
        filterGains:
          initAlpha: 2 # 5 # 0.0
          initBeta: 2 # 1 # 0.0 # 0.00001
          initGamma: 1 # 2 # 0.0
          finalAlpha: 2 # 5 # 0.0
          finalBeta: 2 # 1 # 0.0 # 0.00001
          finalGamma: 1 # 2 # 0.0

# Transition from initial state to RL execution
transitions:
# configure the transitions between every states
- [RL_State, OK, RL_State, Strict]

init: RL_State

Robot:
  H1:  
    mc_rtc_joints_order: [
      "left_hip_yaw_joint",      
      "left_hip_roll_joint",       
      "left_hip_pitch_joint",    
      "left_knee_joint",         
      "left_ankle_joint",        
      "right_hip_yaw_joint",     
      "right_hip_roll_joint",    
      "right_hip_pitch_joint",   
      "right_knee_joint",        
      "right_ankle_joint",       
      "torso_joint",             
      "left_shoulder_pitch_joint",  
      "left_shoulder_roll_joint",     
      "left_shoulder_yaw_joint",    
      "left_elbow_joint",           
      "right_shoulder_pitch_joint", 
      "right_shoulder_roll_joint",  
      "right_shoulder_yaw_joint",   
      "right_elbow_joint"           
    ]

policy_path: ["standing_h1.onnx", "walking_h1.onnx", "walking_better_h1.onnx"]  # Path to the RL policy file(s)
policies:
  # index 0 : standing_policy
  - robot_name: "H1"
    is_torque_control: false
    use_QP: true
    simulator: "Maniskill"
    used_joints_index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] #legs
    pd_gains_ratio: 1.0
    kp:
        left_hip_yaw_joint: 100.0
        left_hip_roll_joint: 100.0
        left_hip_pitch_joint: 100.0
        left_knee_joint: 100.0
        left_ankle_joint: 20.0
        right_hip_yaw_joint: 100.0
        right_hip_roll_joint: 100.0
        right_hip_pitch_joint: 100.0
        right_knee_joint: 100.0
        right_ankle_joint: 20.0
        torso_joint: 100.0
        left_shoulder_pitch_joint: 100.0
        left_shoulder_roll_joint: 100.0
        left_shoulder_yaw_joint: 100.0
        left_elbow_joint: 100.0
        right_shoulder_pitch_joint: 100.0
        right_shoulder_roll_joint: 100.0
        right_shoulder_yaw_joint: 100.0
        right_elbow_joint: 100.0
    kd:
        left_hip_yaw_joint: 10.0
        left_hip_roll_joint: 10.0
        left_hip_pitch_joint: 10.0
        left_knee_joint: 10.0
        left_ankle_joint: 4.0
        right_hip_yaw_joint: 10.0
        right_hip_roll_joint: 10.0
        right_hip_pitch_joint: 10.0
        right_knee_joint: 10.0
        right_ankle_joint: 4.0
        torso_joint: 10.0
        left_shoulder_pitch_joint: 5.0
        left_shoulder_roll_joint: 5.0
        left_shoulder_yaw_joint: 5.0
        left_elbow_joint: 5.0
        right_shoulder_pitch_joint: 5.0
        right_shoulder_roll_joint: 5.0
        right_shoulder_yaw_joint: 5.0
        right_elbow_joint: 5.0
  # index 1 : walking_policy
  - robot_name: "H1"
    is_torque_control: false
    use_QP: true
    simulator: "Maniskill"
    used_joints_index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] #legs
    pd_gains_ratio: 1.0
    kp:
        left_hip_yaw_joint: 100.0
        left_hip_roll_joint: 100.0
        left_hip_pitch_joint: 100.0
        left_knee_joint: 100.0
        left_ankle_joint: 20.0
        right_hip_yaw_joint: 100.0
        right_hip_roll_joint: 100.0
        right_hip_pitch_joint: 100.0
        right_knee_joint: 100.0
        right_ankle_joint: 20.0
        torso_joint: 100.0
        left_shoulder_pitch_joint: 100.0
        left_shoulder_roll_joint: 100.0
        left_shoulder_yaw_joint: 100.0
        left_elbow_joint: 100.0
        right_shoulder_pitch_joint: 100.0
        right_shoulder_roll_joint: 100.0
        right_shoulder_yaw_joint: 100.0
        right_elbow_joint: 100.0
    kd:
        left_hip_yaw_joint: 10.0
        left_hip_roll_joint: 10.0
        left_hip_pitch_joint: 10.0
        left_knee_joint: 10.0
        left_ankle_joint: 4.0
        right_hip_yaw_joint: 10.0
        right_hip_roll_joint: 10.0
        right_hip_pitch_joint: 10.0
        right_knee_joint: 10.0
        right_ankle_joint: 4.0
        torso_joint: 10.0
        left_shoulder_pitch_joint: 5.0
        left_shoulder_roll_joint: 5.0
        left_shoulder_yaw_joint: 5.0
        left_elbow_joint: 5.0
        right_shoulder_pitch_joint: 5.0
        right_shoulder_roll_joint: 5.0
        right_shoulder_yaw_joint: 5.0
        right_elbow_joint: 5.0
    speed_multiplier_joystick: 0.4
  # index 2 : better walking policy
  - robot_name: "H1"
    is_torque_control: false
    use_QP: true
    simulator: "Maniskill"
    used_joints_index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] #legs
    pd_gains_ratio: 0.9
    kp:
        left_hip_yaw_joint: 200.0
        left_hip_roll_joint: 200.0
        left_hip_pitch_joint: 200.0
        left_knee_joint: 300.0
        left_ankle_joint: 40.0
        right_hip_yaw_joint: 200.0
        right_hip_roll_joint: 200.0
        right_hip_pitch_joint: 200.0
        right_knee_joint: 300.0
        right_ankle_joint: 40.0
        torso_joint: 100.0
        left_shoulder_pitch_joint: 100.0
        left_shoulder_roll_joint: 100.0
        left_shoulder_yaw_joint: 100.0
        left_elbow_joint: 100.0
        right_shoulder_pitch_joint: 100.0
        right_shoulder_roll_joint: 100.0
        right_shoulder_yaw_joint: 100.0
        right_elbow_joint: 100.0
    kd:
        left_hip_yaw_joint: 5.0
        left_hip_roll_joint: 5.0
        left_hip_pitch_joint: 5.0
        left_knee_joint: 6.0
        left_ankle_joint: 2.0
        right_hip_yaw_joint: 5.0
        right_hip_roll_joint: 5.0
        right_hip_pitch_joint: 5.0
        right_knee_joint: 6.0
        right_ankle_joint: 2.0
        torso_joint: 10.0
        left_shoulder_pitch_joint: 5.0
        left_shoulder_roll_joint: 5.0
        left_shoulder_yaw_joint: 5.0
        left_elbow_joint: 5.0
        right_shoulder_pitch_joint: 5.0
        right_shoulder_roll_joint: 5.0
        right_shoulder_yaw_joint: 5.0
        right_elbow_joint: 5.0
    speed_multiplier_joystick: 0.4

use_async_inference: false

log_timing: true
timing_log_interval: 100